#!/bin/bash

# ุชุญุฏูุฏ ูุณุงุฑ ููู ุงูุชูููู
RCLONE_CONFIG="/root/.config/rclone/rclone.conf"

echo "๐ ุฌุงุฑู ูุญุงููุฉ ุชุญุฏูุซ ุฑููุฒ rclone ุจุงุณุชุฎุฏุงู ููู ุงูุชูููู: $RCLONE_CONFIG"

# ูุงุฆูุฉ ุจุฃุณูุงุก ุงูุฑูููุชุงุช ุงูุชู ุชุฑูุฏ ุชุญุฏูุซูุง
REMOTES=("gdrive_main" "gdrive_account2" "gdrive_account3" "gdrive_account4" "gdrive_account5")

# ุงูุชุญูู ูู ูุฌูุฏ ููู ุงูุชูููู
if [ ! -f "$RCLONE_CONFIG" ]; then
    echo "โ ุฎุทุฃ: ููู ุงูุชูููู ุบูุฑ ููุฌูุฏ ูู $RCLONE_CONFIG."
    echo "ูุฑุฌู ุงูุชุฃูุฏ ูู ุชุดุบูู ุงูุฎููุฉ ุงูุชู ุชูุดุฆ ููู rclone.conf ุฃููุงู."
    exit 1
fi

# ุงููุฑูุฑ ุนูู ูู ุฑูููุช ููุญุงููุฉ ุฅุนุงุฏุฉ ุงูุงุชุตุงู/ุงูุชุญุฏูุซ
for remote in "${REMOTES[@]}"; do
    echo "\n--- ุฌุงุฑู ูุนุงูุฌุฉ ุงูุฑูููุช: $remote ---"
    # ุงุณุชุฎุฏุงู rclone config reconnect ููุญุงููุฉ ุชุญุฏูุซ ุงูุฑูุฒ
    # ุงุณุชุฎุฏุงู --verbose ูุนุฑุถ ุงููุฒูุฏ ูู ุงูุชูุงุตูู
    # ูุฏ ูุชุทูุจ ูุฐุง ุงูุฃูุฑ ุชูุงุนูุงู ุฅุฐุง ูุงู ุงูู refresh_token ุบูุฑ ุตุงูุญ
    rclone --config "$RCLONE_CONFIG" config reconnect "$remote": --verbose

    # ุงูุชุญูู ูู ุญุงูุฉ ุงูุฎุฑูุฌ ููุฃูุฑ ุงูุณุงุจู
    if [ $? -eq 0 ]; then
        echo "โ ุชู ูุญุงููุฉ ุชุญุฏูุซ ุงูุฑูููุช $remote ุจูุฌุงุญ."
    else
        echo "โ๏ธ ูุดูุช ูุญุงููุฉ ุชุญุฏูุซ ุงูุฑูููุช $remote."
        echo "ูุฏ ุชุญุชุงุฌ ุฅูู ุฅุนุงุฏุฉ ุงููุตุงุฏูุฉ ูุฏููุงู ููุฐุง ุงูุฑูููุช."
    fi
done

echo "\nโ ุงูุชููุช ูุญุงููุฉ ุชุญุฏูุซ ุงูุฑููุฒ ูุฌููุน ุงูุฑูููุชุงุช ุงููุญุฏุฏุฉ."
echo "ูุฑุฌู ูุญุต ุงููุฎุฑุฌุงุช ูุฃู ุฑุณุงุฆู ุฎุทุฃ ุฃู ุทูุจุงุช ุชูุงุนููุฉ."
