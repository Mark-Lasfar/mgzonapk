{"version":3,"names":["BankVerificationPage","params","cov_ubxp5w4s1","f","locale","s","t","_server","getTranslations","namespace","session","_auth","auth","user","id","b","console","log","_navigation","redirect","handleBankVerification","formData","_db","connectToDatabase","seller","_sellermodel","default","findOne","userId","Error","bankInfo","accountName","get","accountNumber","bankName","swiftCode","verified","updateOne","$set","error","_jsxruntime","jsxs","className","defaultMessage","jsx","href","action","htmlFor","name","type","required","defaultValue"],"sources":["/home/hager/new/my-nextjs-project-master (3)/my-nextjs-project-master/app/[locale]/(root)/account/bank-verification/page.tsx"],"sourcesContent":["'use server';\n\nimport { getTranslations } from 'next-intl/server';\nimport { auth } from '@/auth';\nimport { redirect } from 'next/navigation';\nimport Seller from '@/lib/db/models/seller.model';\nimport { connectToDatabase } from '@/lib/db';\n\ninterface BankVerificationPageProps {\n  params: Promise<{ locale: string }>;\n}\n\nexport default async function BankVerificationPage({ params }: BankVerificationPageProps) {\n  const { locale } = await params;\n  const t = await getTranslations({ locale, namespace: 'bankVerification' });\n  const session = await auth();\n\n  if (!session?.user?.id) {\n    console.log('لا يوجد جلسة مستخدم، يتم إعادة التوجيه إلى تسجيل الدخول');\n    redirect(`/${locale}/sign-in`);\n  }\n\n  async function handleBankVerification(formData: FormData) {\n    'use server';\n    try {\n      await connectToDatabase();\n      const seller = await Seller.findOne({ userId: session.user.id });\n      if (!seller) {\n        throw new Error('لم يتم العثور على ملف بائع');\n      }\n\n      const bankInfo = {\n        accountName: formData.get('accountName') as string,\n        accountNumber: formData.get('accountNumber') as string,\n        bankName: formData.get('bankName') as string,\n        swiftCode: formData.get('swiftCode') as string,\n        verified: true, // في الواقع، لازم يكون في عملية تحقق حقيقية\n      };\n\n      await Seller.updateOne(\n        { userId: session.user.id },\n        { $set: { bankInfo } }\n      );\n      console.log('تم تحديث معلومات البنك للبائع:', session.user.id);\n      redirect(`/${locale}/account/subscriptions`);\n    } catch (error) {\n      console.error('خطأ في التحقق من البنك:', error);\n      throw error;\n    }\n  }\n\n  try {\n    await connectToDatabase();\n    const seller = await Seller.findOne({ userId: session.user.id });\n    if (!seller) {\n      return (\n        <div className=\"text-red-500 text-center p-4\">\n          {t('errors.sellerNotFound', {\n            defaultMessage: 'لم يتم العثور على ملف بائع. يرجى التسجيل كبائع.',\n          })}\n          <br />\n          <a href={`/${locale}/seller-registration`} className=\"text-blue-500 underline\">\n            {t('account.startSelling', { defaultMessage: 'ابدأ البيع' })}\n          </a>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"container mx-auto p-4\">\n        <h1 className=\"text-2xl font-bold mb-4\">{t('title')}</h1>\n        <form action={handleBankVerification} className=\"space-y-4 max-w-md mx-auto\">\n          <div>\n            <label htmlFor=\"accountName\" className=\"block text-sm font-medium\">\n              {t('accountName')}\n            </label>\n            <input\n              id=\"accountName\"\n              name=\"accountName\"\n              type=\"text\"\n              className=\"mt-1 block w-full border rounded-md p-2\"\n              required\n              defaultValue={seller.bankInfo.accountName || ''}\n            />\n          </div>\n          <div>\n            <label htmlFor=\"accountNumber\" className=\"block text-sm font-medium\">\n              {t('accountNumber')}\n            </label>\n            <input\n              id=\"accountNumber\"\n              name=\"accountNumber\"\n              type=\"text\"\n              className=\"mt-1 block w-full border rounded-md p-2\"\n              required\n              defaultValue={seller.bankInfo.accountNumber || ''}\n            />\n          </div>\n          <div>\n            <label htmlFor=\"bankName\" className=\"block text-sm font-medium\">\n              {t('bankName')}\n            </label>\n            <input\n              id=\"bankName\"\n              name=\"bankName\"\n              type=\"text\"\n              className=\"mt-1 block w-full border rounded-md p-2\"\n              required\n              defaultValue={seller.bankInfo.bankName || ''}\n            />\n          </div>\n          <div>\n            <label htmlFor=\"swiftCode\" className=\"block text-sm font-medium\">\n              {t('swiftCode')}\n            </label>\n            <input\n              id=\"swiftCode\"\n              name=\"swiftCode\"\n              type=\"text\"\n              className=\"mt-1 block w-full border rounded-md p-2\"\n              required\n              defaultValue={seller.bankInfo.swiftCode || ''}\n            />\n          </div>\n          <button\n            type=\"submit\"\n            className=\"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600\"\n          >\n            {t('submit')}\n          </button>\n        </form>\n      </div>\n    );\n  } catch (error) {\n    console.error('خطأ في صفحة التحقق من البنك:', error);\n    return (\n      <div className=\"text-red-500 text-center p-4\">\n        {t('errors.serverError', { defaultMessage: 'حدث خطأ. يرجى المحاولة لاحقًا.' })}\n      </div>\n    );\n  }\n}"],"mappings":"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","ignoreList":[]}