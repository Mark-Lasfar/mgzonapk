{"version":3,"names":["cov_1yoqt5ctdg","actualCoverage","s","initializeFirebaseMessaging","app","_app","initializeApp","_config","firebaseConfig","f","messaging","_messaging","getMessaging","permission","Notification","requestPermission","b","Error","token","getToken","vapidKey","process","env","NEXT_PUBLIC_VAPID_PUBLIC_KEY","console","log","registerDeviceToken","error","response","fetch","method","headers","body","JSON","stringify","ok","json"],"sources":["/home/hager/new/my-nextjs-project-master (3)/my-nextjs-project-master/lib/firebase/messaging.ts"],"sourcesContent":["import { initializeApp } from 'firebase/app';\nimport { getMessaging, getToken } from 'firebase/messaging';\nimport { firebaseConfig } from './config';\n\nconst app = initializeApp(firebaseConfig);\n\nexport async function initializeFirebaseMessaging() {\n  try {\n    const messaging = getMessaging(app);\n    \n    const permission = await Notification.requestPermission();\n    if (permission !== 'granted') {\n      throw new Error('Notification permission denied');\n    }\n\n    const token = await getToken(messaging, {\n      vapidKey: process.env.NEXT_PUBLIC_VAPID_PUBLIC_KEY\n    });\n\n    if (token) {\n      console.log('FCM Token:', token);\n      await registerDeviceToken(token);\n    }\n\n    return token;\n  } catch (error) {\n    console.error('Error initializing Firebase Messaging:', error);\n    return null;\n  }\n}\n\nasync function registerDeviceToken(token: string) {\n  try {\n    const response = await fetch('/api/notifications/register', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ token })\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to register device token');\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('Error registering device token:', error);\n    throw error;\n  }\n}"],"mappings":"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","ignoreList":[]}