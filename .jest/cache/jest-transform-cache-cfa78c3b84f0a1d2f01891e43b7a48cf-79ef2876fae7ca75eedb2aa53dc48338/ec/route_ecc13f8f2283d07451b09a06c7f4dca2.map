{"version":3,"names":["POST","req","cov_2m71yu9kul","f","s","_db","connectToDatabase","email","code","json","b","_server","NextResponse","error","status","record","_verificationcodemodel","default","findOne","expiresAt","Date","success"],"sources":["/home/hager/new/my-nextjs-project-master (3)/my-nextjs-project-master/app/api/auth/verify-code/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport VerificationCode from '@/lib/db/models/verification-code.model';\nimport { connectToDatabase } from '@/lib/db';\n\nexport async function POST(req: Request) {\n  await connectToDatabase();\n  const { email, code } = await req.json();\n\n  if (!email || !code) {\n    return NextResponse.json({ error: 'Email and code are required' }, { status: 400 });\n  }\n\n  const record = await VerificationCode.findOne({ email, code });\n\n  if (!record) {\n    return NextResponse.json({ error: 'Invalid or expired code' }, { status: 401 });\n  }\n\n  if (record.expiresAt < new Date()) {\n    return NextResponse.json({ error: 'Code expired' }, { status: 401 });\n  }\n\n  return NextResponse.json({ success: true });\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BAIsB;;;;;;WAAAA,IAAA;;;;;kCAJO;;;wEACA;;;kCACK;;;;;;;;;;;;;;;AAE3B,eAAeA,KAAKC,GAAY;EAAA;EAAAC,cAAA,GAAAC,CAAA;EAAAD,cAAA,GAAAE,CAAA;EACrC,MAAM,IAAAC,GAAA,CAAAC,iBAAiB;EACvB,MAAM;IAAEC,KAAK;IAAEC;EAAI,CAAE;EAAA;EAAA,CAAAN,cAAA,GAAAE,CAAA,OAAG,MAAMH,GAAA,CAAIQ,IAAI;EAAA;EAAAP,cAAA,GAAAE,CAAA;EAEtC;EAAI;EAAA,CAAAF,cAAA,GAAAQ,CAAA,WAACH,KAAA;EAAA;EAAA,CAAAL,cAAA,GAAAQ,CAAA,UAAS,CAACF,IAAA,GAAM;IAAA;IAAAN,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAE,CAAA;IACnB,OAAOO,OAAA,CAAAC,YAAY,CAACH,IAAI,CAAC;MAAEI,KAAA,EAAO;IAA8B,GAAG;MAAEC,MAAA,EAAQ;IAAI;EACnF;EAAA;EAAA;IAAAZ,cAAA,GAAAQ,CAAA;EAAA;EAEA,MAAMK,MAAA;EAAA;EAAA,CAAAb,cAAA,GAAAE,CAAA,QAAS,MAAMY,sBAAA,CAAAC,OAAgB,CAACC,OAAO,CAAC;IAAEX,KAAA;IAAOC;EAAK;EAAA;EAAAN,cAAA,GAAAE,CAAA;EAE5D,IAAI,CAACW,MAAA,EAAQ;IAAA;IAAAb,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAE,CAAA;IACX,OAAOO,OAAA,CAAAC,YAAY,CAACH,IAAI,CAAC;MAAEI,KAAA,EAAO;IAA0B,GAAG;MAAEC,MAAA,EAAQ;IAAI;EAC/E;EAAA;EAAA;IAAAZ,cAAA,GAAAQ,CAAA;EAAA;EAAAR,cAAA,GAAAE,CAAA;EAEA,IAAIW,MAAA,CAAOI,SAAS,GAAG,IAAIC,IAAA,IAAQ;IAAA;IAAAlB,cAAA,GAAAQ,CAAA;IAAAR,cAAA,GAAAE,CAAA;IACjC,OAAOO,OAAA,CAAAC,YAAY,CAACH,IAAI,CAAC;MAAEI,KAAA,EAAO;IAAe,GAAG;MAAEC,MAAA,EAAQ;IAAI;EACpE;EAAA;EAAA;IAAAZ,cAAA,GAAAQ,CAAA;EAAA;EAAAR,cAAA,GAAAE,CAAA;EAEA,OAAOO,OAAA,CAAAC,YAAY,CAACH,IAAI,CAAC;IAAEY,OAAA,EAAS;EAAK;AAC3C","ignoreList":[]}