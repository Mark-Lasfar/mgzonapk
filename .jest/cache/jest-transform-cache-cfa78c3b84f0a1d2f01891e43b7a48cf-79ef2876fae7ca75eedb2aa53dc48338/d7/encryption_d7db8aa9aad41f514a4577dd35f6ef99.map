{"version":3,"names":["decrypt","cov_mn761e3p5","f","s","encrypt","ENCRYPTION_KEY","b","process","env","console","error","ALGORITHM","IV_LENGTH","text","iv","_crypto","default","randomBytes","key","Buffer","from","cipher","createCipheriv","encrypted","update","concat","final","toString","textParts","split","shift","encryptedText","join","decipher","createDecipheriv","decrypted"],"sources":["/home/hager/new/my-nextjs-project-master (3)/my-nextjs-project-master/lib/utils/encryption.ts"],"sourcesContent":["import crypto from 'crypto';\n\nconst ENCRYPTION_KEY = process.env.ENCRYPTION_KEY || '73794b6a0f8c949bb3e0e40b8d4c8c7fc1060f5c01427b021485effbdb962492';\n\nif (!ENCRYPTION_KEY) {\n  console.error('Warning: ENCRYPTION_KEY is not set. Using default key for development.');\n}\n\nconst ALGORITHM = 'aes-256-cbc';\nconst IV_LENGTH = 16;\n\nexport function encrypt(text: string): string {\n  const iv = crypto.randomBytes(IV_LENGTH);\n  const key = Buffer.from(ENCRYPTION_KEY, 'hex');\n  const cipher = crypto.createCipheriv(ALGORITHM, key, iv);\n  let encrypted = cipher.update(text);\n  encrypted = Buffer.concat([encrypted, cipher.final()]);\n  return iv.toString('hex') + ':' + encrypted.toString('hex');\n}\n\nexport function decrypt(text: string): string {\n  const textParts = text.split(':');\n  const iv = Buffer.from(textParts.shift()!, 'hex');\n  const encryptedText = Buffer.from(textParts.join(':'), 'hex');\n  const key = Buffer.from(ENCRYPTION_KEY, 'hex');\n  const decipher = crypto.createDecipheriv(ALGORITHM, key, iv);\n  let decrypted = decipher.update(encryptedText);\n  decrypted = Buffer.concat([decrypted, decipher.final()]);\n  return decrypted.toString();\n}"],"mappings":"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","ignoreList":[]}