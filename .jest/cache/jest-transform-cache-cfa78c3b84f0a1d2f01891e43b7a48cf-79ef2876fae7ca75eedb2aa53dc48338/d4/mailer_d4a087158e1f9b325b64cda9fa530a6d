2aaf71d08a7a0ae1684f58219e295001
"use strict";

/* istanbul ignore next */
function cov_1dqtnypwma() {
  var path = "/home/hager/new/my-nextjs-project-master (3)/my-nextjs-project-master/lib/services/email/mailer.ts";
  var hash = "a25ff544d3eafd30ab13a97ebd98b8ecce1776a8";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/home/hager/new/my-nextjs-project-master (3)/my-nextjs-project-master/lib/services/email/mailer.ts",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 0
        },
        end: {
          line: 4,
          column: 3
        }
      },
      "1": {
        start: {
          line: 5,
          column: 0
        },
        end: {
          line: 10,
          column: 3
        }
      },
      "2": {
        start: {
          line: 8,
          column: 8
        },
        end: {
          line: 8,
          column: 28
        }
      },
      "3": {
        start: {
          line: 11,
          column: 34
        },
        end: {
          line: 11,
          column: 81
        }
      },
      "4": {
        start: {
          line: 12,
          column: 15
        },
        end: {
          line: 12,
          column: 44
        }
      },
      "5": {
        start: {
          line: 13,
          column: 17
        },
        end: {
          line: 13,
          column: 54
        }
      },
      "6": {
        start: {
          line: 14,
          column: 30
        },
        end: {
          line: 14,
          column: 73
        }
      },
      "7": {
        start: {
          line: 16,
          column: 4
        },
        end: {
          line: 18,
          column: 6
        }
      },
      "8": {
        start: {
          line: 22,
          column: 8
        },
        end: {
          line: 35,
          column: 11
        }
      },
      "9": {
        start: {
          line: 36,
          column: 8
        },
        end: {
          line: 36,
          column: 32
        }
      },
      "10": {
        start: {
          line: 39,
          column: 8
        },
        end: {
          line: 39,
          column: 72
        }
      },
      "11": {
        start: {
          line: 42,
          column: 8
        },
        end: {
          line: 46,
          column: 10
        }
      },
      "12": {
        start: {
          line: 49,
          column: 8
        },
        end: {
          line: 72,
          column: 9
        }
      },
      "13": {
        start: {
          line: 50,
          column: 28
        },
        end: {
          line: 50,
          column: 59
        }
      },
      "14": {
        start: {
          line: 51,
          column: 29
        },
        end: {
          line: 51,
          column: 47
        }
      },
      "15": {
        start: {
          line: 52,
          column: 12
        },
        end: {
          line: 60,
          column: 15
        }
      },
      "16": {
        start: {
          line: 62,
          column: 29
        },
        end: {
          line: 62,
          column: 47
        }
      },
      "17": {
        start: {
          line: 63,
          column: 12
        },
        end: {
          line: 71,
          column: 15
        }
      },
      "18": {
        start: {
          line: 75,
          column: 26
        },
        end: {
          line: 75,
          column: 36
        }
      },
      "19": {
        start: {
          line: 76,
          column: 25
        },
        end: {
          line: 76,
          column: 43
        }
      },
      "20": {
        start: {
          line: 77,
          column: 8
        },
        end: {
          line: 113,
          column: 9
        }
      },
      "21": {
        start: {
          line: 78,
          column: 27
        },
        end: {
          line: 81,
          column: 14
        }
      },
      "22": {
        start: {
          line: 82,
          column: 12
        },
        end: {
          line: 91,
          column: 15
        }
      },
      "23": {
        start: {
          line: 92,
          column: 12
        },
        end: {
          line: 92,
          column: 26
        }
      },
      "24": {
        start: {
          line: 94,
          column: 12
        },
        end: {
          line: 111,
          column: 15
        }
      },
      "25": {
        start: {
          line: 112,
          column: 12
        },
        end: {
          line: 112,
          column: 24
        }
      },
      "26": {
        start: {
          line: 116,
          column: 25
        },
        end: {
          line: 116,
          column: 43
        }
      },
      "27": {
        start: {
          line: 117,
          column: 8
        },
        end: {
          line: 150,
          column: 11
        }
      },
      "28": {
        start: {
          line: 153,
          column: 25
        },
        end: {
          line: 153,
          column: 43
        }
      },
      "29": {
        start: {
          line: 154,
          column: 8
        },
        end: {
          line: 185,
          column: 11
        }
      },
      "30": {
        start: {
          line: 163,
          column: 46
        },
        end: {
          line: 167,
          column: 13
        }
      },
      "31": {
        start: {
          line: 179,
          column: 42
        },
        end: {
          line: 179,
          column: 121
        }
      },
      "32": {
        start: {
          line: 188,
          column: 25
        },
        end: {
          line: 188,
          column: 43
        }
      },
      "33": {
        start: {
          line: 189,
          column: 8
        },
        end: {
          line: 221,
          column: 11
        }
      },
      "34": {
        start: {
          line: 224,
          column: 21
        },
        end: {
          line: 224,
          column: 39
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 7,
            column: 9
          },
          end: {
            line: 7,
            column: 10
          }
        },
        loc: {
          start: {
            line: 7,
            column: 20
          },
          end: {
            line: 9,
            column: 5
          }
        },
        line: 7
      },
      "1": {
        name: "_interop_require_default",
        decl: {
          start: {
            line: 15,
            column: 9
          },
          end: {
            line: 15,
            column: 33
          }
        },
        loc: {
          start: {
            line: 15,
            column: 39
          },
          end: {
            line: 19,
            column: 1
          }
        },
        line: 15
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 21,
            column: 4
          },
          end: {
            line: 21,
            column: 5
          }
        },
        loc: {
          start: {
            line: 21,
            column: 17
          },
          end: {
            line: 37,
            column: 5
          }
        },
        line: 21
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 38,
            column: 4
          },
          end: {
            line: 38,
            column: 5
          }
        },
        loc: {
          start: {
            line: 38,
            column: 21
          },
          end: {
            line: 40,
            column: 5
          }
        },
        line: 38
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 41,
            column: 4
          },
          end: {
            line: 41,
            column: 5
          }
        },
        loc: {
          start: {
            line: 41,
            column: 18
          },
          end: {
            line: 47,
            column: 5
          }
        },
        line: 41
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 48,
            column: 4
          },
          end: {
            line: 48,
            column: 5
          }
        },
        loc: {
          start: {
            line: 48,
            column: 29
          },
          end: {
            line: 73,
            column: 5
          }
        },
        line: 48
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 74,
            column: 4
          },
          end: {
            line: 74,
            column: 5
          }
        },
        loc: {
          start: {
            line: 74,
            column: 24
          },
          end: {
            line: 114,
            column: 5
          }
        },
        line: 74
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 115,
            column: 4
          },
          end: {
            line: 115,
            column: 5
          }
        },
        loc: {
          start: {
            line: 115,
            column: 40
          },
          end: {
            line: 151,
            column: 5
          }
        },
        line: 115
      },
      "8": {
        name: "(anonymous_8)",
        decl: {
          start: {
            line: 152,
            column: 4
          },
          end: {
            line: 152,
            column: 5
          }
        },
        loc: {
          start: {
            line: 152,
            column: 41
          },
          end: {
            line: 186,
            column: 5
          }
        },
        line: 152
      },
      "9": {
        name: "(anonymous_9)",
        decl: {
          start: {
            line: 163,
            column: 38
          },
          end: {
            line: 163,
            column: 39
          }
        },
        loc: {
          start: {
            line: 163,
            column: 46
          },
          end: {
            line: 167,
            column: 13
          }
        },
        line: 163
      },
      "10": {
        name: "(anonymous_10)",
        decl: {
          start: {
            line: 179,
            column: 34
          },
          end: {
            line: 179,
            column: 35
          }
        },
        loc: {
          start: {
            line: 179,
            column: 42
          },
          end: {
            line: 179,
            column: 121
          }
        },
        line: 179
      },
      "11": {
        name: "(anonymous_11)",
        decl: {
          start: {
            line: 187,
            column: 4
          },
          end: {
            line: 187,
            column: 5
          }
        },
        loc: {
          start: {
            line: 187,
            column: 37
          },
          end: {
            line: 222,
            column: 5
          }
        },
        line: 187
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 16,
            column: 11
          },
          end: {
            line: 18,
            column: 5
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 16,
            column: 35
          },
          end: {
            line: 16,
            column: 38
          }
        }, {
          start: {
            line: 16,
            column: 41
          },
          end: {
            line: 18,
            column: 5
          }
        }],
        line: 16
      },
      "1": {
        loc: {
          start: {
            line: 16,
            column: 11
          },
          end: {
            line: 16,
            column: 32
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 16,
            column: 11
          },
          end: {
            line: 16,
            column: 14
          }
        }, {
          start: {
            line: 16,
            column: 18
          },
          end: {
            line: 16,
            column: 32
          }
        }],
        line: 16
      },
      "2": {
        loc: {
          start: {
            line: 44,
            column: 18
          },
          end: {
            line: 44,
            column: 54
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 44,
            column: 18
          },
          end: {
            line: 44,
            column: 42
          }
        }, {
          start: {
            line: 44,
            column: 46
          },
          end: {
            line: 44,
            column: 54
          }
        }],
        line: 44
      },
      "3": {
        loc: {
          start: {
            line: 64,
            column: 23
          },
          end: {
            line: 64,
            column: 77
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 64,
            column: 48
          },
          end: {
            line: 64,
            column: 61
          }
        }, {
          start: {
            line: 64,
            column: 64
          },
          end: {
            line: 64,
            column: 77
          }
        }],
        line: 64
      },
      "4": {
        loc: {
          start: {
            line: 95,
            column: 23
          },
          end: {
            line: 99,
            column: 33
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 95,
            column: 48
          },
          end: {
            line: 99,
            column: 17
          }
        }, {
          start: {
            line: 99,
            column: 20
          },
          end: {
            line: 99,
            column: 33
          }
        }],
        line: 95
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      sources: ["/home/hager/new/my-nextjs-project-master (3)/my-nextjs-project-master/lib/services/email/mailer.ts"],
      sourcesContent: ["import nodemailer from 'nodemailer';\nimport { EMAIL_CONFIG } from '@/lib/config/email';\nimport { logger } from '@/lib/api/services/logging';\nimport crypto from 'crypto';\n\n// \u062A\u0639\u0631\u064A\u0641 \u0627\u0644\u0623\u0646\u0648\u0627\u0639\ninterface EmailOptions {\n  to: string;\n  subject: string;\n  html: string;\n  text: string;\n}\n\ninterface OrderItem {\n  name: string;\n  quantity: number;\n  price: number;\n}\n\ninterface Order {\n  _id: string;\n  items: OrderItem[];\n  totalPrice: number;\n}\n\ninterface User {\n  name: string;\n}\n\ninterface EmailMetadata {\n  timestamp: string;\n  user: string;\n  requestId: string;\n}\n\nclass EmailService {\n  private transporter: nodemailer.Transporter;\n\n  constructor() {\n    this.transporter = nodemailer.createTransport({\n      service: 'gmail',\n      auth: {\n        user: EMAIL_CONFIG.SMTP.USER,\n        pass: EMAIL_CONFIG.SMTP.PASS?.replace(/\\s/g, ''),\n      },\n      pool: true,\n      maxConnections: 5,\n      maxMessages: 100,\n      secure: true,\n      port: 465,\n      debug: process.env.NODE_ENV === 'development',\n      logger: process.env.NODE_ENV === 'development',\n    });\n\n    this.verifyConnection();\n  }\n\n  private formatDate(date: Date): string {\n    return date.toISOString()\n      .replace(/T/, ' ')\n      .replace(/\\..+/, '');\n  }\n\n  private getMetadata(): EmailMetadata {\n    return {\n      timestamp: this.formatDate(new Date()),\n      user: process.env.CURRENT_USER || 'system',\n      requestId: crypto.randomUUID()\n    };\n  }\n\n  private async verifyConnection() {\n    try {\n      const isReady = await this.transporter.verify();\n      const metadata = this.getMetadata();\n\n      logger.info('SMTP Connection Status', {\n        ready: isReady,\n        email: EMAIL_CONFIG.SMTP.USER,\n        host: EMAIL_CONFIG.SMTP.HOST,\n        metadata: {\n          service: 'api',\n          ...metadata\n        }\n      });\n    } catch (error) {\n      const metadata = this.getMetadata();\n      \n      logger.error('SMTP Connection Error', {\n        error: error instanceof Error ? error.message : String(error),\n        email: EMAIL_CONFIG.SMTP.USER,\n        host: EMAIL_CONFIG.SMTP.HOST,\n        metadata: {\n          service: 'api',\n          ...metadata\n        }\n      });\n    }\n  }\n\n  private async send(options: EmailOptions) {\n    const startTime = Date.now();\n    const metadata = this.getMetadata();\n\n    try {\n      const result = await this.transporter.sendMail({\n        from: `\"${EMAIL_CONFIG.FROM.NAME}\" <${EMAIL_CONFIG.FROM.EMAIL}>`,\n        ...options,\n      });\n\n      logger.info('Email sent successfully', {\n        messageId: result.messageId,\n        to: options.to,\n        subject: options.subject,\n        duration: Date.now() - startTime,\n        metadata: {\n          service: 'api',\n          ...metadata\n        }\n      });\n\n      return result;\n    } catch (error) {\n      logger.error('Failed to send email', {\n        error: error instanceof Error ? {\n          message: error.message,\n          name: error.name,\n          stack: error.stack,\n        } : String(error),\n        to: options.to,\n        subject: options.subject,\n        duration: Date.now() - startTime,\n        metadata: {\n          service: 'api',\n          ...metadata\n        },\n        smtp: {\n          user: EMAIL_CONFIG.SMTP.USER,\n          host: EMAIL_CONFIG.SMTP.HOST,\n        },\n      });\n      throw error;\n    }\n  }\n\n  public async sendVerificationCode(options: {\n    to: string;\n    code: string;\n    name: string;\n  }) {\n    const metadata = this.getMetadata();\n    \n    return this.send({\n      to: options.to,\n      subject: EMAIL_CONFIG.TEMPLATES.VERIFICATION.SUBJECT,\n      html: `\n        <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n          <h1 style=\"color: #333; text-align: center;\">Email Verification</h1>\n          <p>Hello ${options.name},</p>\n          <p>Please use the following code to verify your email address:</p>\n          <div style=\"background-color: #f4f4f4; padding: 15px; text-align: center; font-size: 24px; letter-spacing: 5px; margin: 20px 0; border-radius: 5px;\">\n            <strong>${options.code}</strong>\n          </div>\n          <p>This code will expire in 10 minutes.</p>\n          <p>If you didn't request this code, please ignore this email.</p>\n          <div style=\"margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee; text-align: center; color: #666;\">\n            <p>This is an automated message from MGZon</p>\n            <p>Sent at: ${metadata.timestamp}</p>\n          </div>\n        </div>\n      `,\n      text: `\n        Hello ${options.name},\n\n        Please use the following code to verify your email address:\n\n        ${options.code}\n\n        This code will expire in 10 minutes.\n\n        If you didn't request this code, please ignore this email.\n\n        MGZon\n        Sent at: ${metadata.timestamp}\n      `,\n    });\n  }\n\n  public async sendOrderConfirmation(options: {\n    to: string;\n    order: Order;\n    user: User;\n  }) {\n    const metadata = this.getMetadata();\n    \n    return this.send({\n      to: options.to,\n      subject: EMAIL_CONFIG.TEMPLATES.ORDER_CONFIRMATION.SUBJECT,\n      html: `\n        <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n          <h1>Order Confirmation</h1>\n          <p>Thank you for your order, ${options.user.name}!</p>\n          <p>Order #${options.order._id}</p>\n          <div style=\"margin: 20px 0;\">\n            ${options.order.items.map(item => `\n              <div style=\"padding: 10px; border-bottom: 1px solid #eee;\">\n                <p>${item.name} x ${item.quantity} - $${(item.price * item.quantity).toFixed(2)}</p>\n              </div>\n            `).join('')}\n          </div>\n          <p><strong>Total:</strong> $${options.order.totalPrice.toFixed(2)}</p>\n          <p>Sent at: ${metadata.timestamp}</p>\n        </div>\n      `,\n      text: `\n        Order Confirmation\n\n        Thank you for your order, ${options.user.name}!\n        Order #${options.order._id}\n\n        ${options.order.items.map(item => \n          `${item.name} x ${item.quantity} - $${(item.price * item.quantity).toFixed(2)}`\n        ).join('\\n')}\n\n        Total: $${options.order.totalPrice.toFixed(2)}\n        \n        Sent at: ${metadata.timestamp}\n      `,\n    });\n  }\n\n  public async sendPasswordReset(options: {\n    to: string;\n    resetToken: string;\n    name: string;\n  }) {\n    const metadata = this.getMetadata();\n\n    return this.send({\n      to: options.to,\n      subject: EMAIL_CONFIG.TEMPLATES.PASSWORD_RESET.SUBJECT,\n      html: `\n        <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n          <h1>Password Reset</h1>\n          <p>Hello ${options.name},</p>\n          <p>Click the button below to reset your password:</p>\n          <div style=\"text-align: center; margin: 20px 0;\">\n            <a href=\"${process.env.NEXT_PUBLIC_BASE_URL}/reset-password/${options.resetToken}\"\n               style=\"background-color: #007bff; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;\">\n              Reset Password\n            </a>\n          </div>\n          <p>If you didn't request this, please ignore this email.</p>\n          <p style=\"color: #666; text-align: center; margin-top: 20px;\">\n            Sent at: ${metadata.timestamp}\n          </p>\n        </div>\n      `,\n      text: `\n        Password Reset\n\n        Hello ${options.name},\n\n        Click the link below to reset your password:\n        ${process.env.NEXT_PUBLIC_BASE_URL}/reset-password/${options.resetToken}\n\n        If you didn't request this, please ignore this email.\n        \n        Sent at: ${metadata.timestamp}\n      `,\n    });\n  }\n}\n\n// \u062A\u0635\u062F\u064A\u0631 \u0646\u0633\u062E\u0629 \u0648\u0627\u062D\u062F\u0629 \u0645\u0646 \u0627\u0644\u062E\u062F\u0645\u0629\nexport const emailService = new EmailService();"],
      names: ["emailService", "EmailService", "constructor", "transporter", "nodemailer", "createTransport", "service", "auth", "user", "EMAIL_CONFIG", "SMTP", "USER", "pass", "PASS", "replace", "pool", "maxConnections", "maxMessages", "secure", "port", "debug", "process", "env", "NODE_ENV", "logger", "verifyConnection", "formatDate", "date", "toISOString", "getMetadata", "timestamp", "Date", "CURRENT_USER", "requestId", "crypto", "randomUUID", "isReady", "verify", "metadata", "info", "ready", "email", "host", "HOST", "error", "Error", "message", "String", "send", "options", "startTime", "now", "result", "sendMail", "from", "FROM", "NAME", "EMAIL", "messageId", "to", "subject", "duration", "name", "stack", "smtp", "sendVerificationCode", "TEMPLATES", "VERIFICATION", "SUBJECT", "html", "code", "text", "sendOrderConfirmation", "ORDER_CONFIRMATION", "order", "_id", "items", "map", "item", "quantity", "price", "toFixed", "join", "totalPrice", "sendPasswordReset", "PASSWORD_RESET", "NEXT_PUBLIC_BASE_URL", "resetToken"],
      mappings: "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"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "a25ff544d3eafd30ab13a97ebd98b8ecce1776a8"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_1dqtnypwma = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_1dqtnypwma();
cov_1dqtnypwma().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
/* istanbul ignore next */
cov_1dqtnypwma().s[1]++;
Object.defineProperty(exports, "emailService", {
  enumerable: true,
  get: function () {
    /* istanbul ignore next */
    cov_1dqtnypwma().f[0]++;
    cov_1dqtnypwma().s[2]++;
    return emailService;
  }
});
const _nodemailer =
/* istanbul ignore next */
(/*#__PURE__*/cov_1dqtnypwma().s[3]++, _interop_require_default(require("nodemailer")));
const _email =
/* istanbul ignore next */
(cov_1dqtnypwma().s[4]++, require("../../config/email"));
const _logging =
/* istanbul ignore next */
(cov_1dqtnypwma().s[5]++, require("../../api/services/logging"));
const _crypto =
/* istanbul ignore next */
(/*#__PURE__*/cov_1dqtnypwma().s[6]++, _interop_require_default(require("crypto")));
function _interop_require_default(obj) {
  /* istanbul ignore next */
  cov_1dqtnypwma().f[1]++;
  cov_1dqtnypwma().s[7]++;
  return /* istanbul ignore next */(cov_1dqtnypwma().b[1][0]++, obj) &&
  /* istanbul ignore next */
  (cov_1dqtnypwma().b[1][1]++, obj.__esModule) ?
  /* istanbul ignore next */
  (cov_1dqtnypwma().b[0][0]++, obj) :
  /* istanbul ignore next */
  (cov_1dqtnypwma().b[0][1]++, {
    default: obj
  });
}
class EmailService {
  constructor() {
    /* istanbul ignore next */
    cov_1dqtnypwma().f[2]++;
    cov_1dqtnypwma().s[8]++;
    this.transporter = _nodemailer.default.createTransport({
      service: 'gmail',
      auth: {
        user: _email.EMAIL_CONFIG.SMTP.USER,
        pass: _email.EMAIL_CONFIG.SMTP.PASS?.replace(/\s/g, '')
      },
      pool: true,
      maxConnections: 5,
      maxMessages: 100,
      secure: true,
      port: 465,
      debug: process.env.NODE_ENV === 'development',
      logger: process.env.NODE_ENV === 'development'
    });
    /* istanbul ignore next */
    cov_1dqtnypwma().s[9]++;
    this.verifyConnection();
  }
  formatDate(date) {
    /* istanbul ignore next */
    cov_1dqtnypwma().f[3]++;
    cov_1dqtnypwma().s[10]++;
    return date.toISOString().replace(/T/, ' ').replace(/\..+/, '');
  }
  getMetadata() {
    /* istanbul ignore next */
    cov_1dqtnypwma().f[4]++;
    cov_1dqtnypwma().s[11]++;
    return {
      timestamp: this.formatDate(new Date()),
      user:
      /* istanbul ignore next */
      (cov_1dqtnypwma().b[2][0]++, process.env.CURRENT_USER) ||
      /* istanbul ignore next */
      (cov_1dqtnypwma().b[2][1]++, 'system'),
      requestId: _crypto.default.randomUUID()
    };
  }
  async verifyConnection() {
    /* istanbul ignore next */
    cov_1dqtnypwma().f[5]++;
    cov_1dqtnypwma().s[12]++;
    try {
      const isReady =
      /* istanbul ignore next */
      (cov_1dqtnypwma().s[13]++, await this.transporter.verify());
      const metadata =
      /* istanbul ignore next */
      (cov_1dqtnypwma().s[14]++, this.getMetadata());
      /* istanbul ignore next */
      cov_1dqtnypwma().s[15]++;
      _logging.logger.info('SMTP Connection Status', {
        ready: isReady,
        email: _email.EMAIL_CONFIG.SMTP.USER,
        host: _email.EMAIL_CONFIG.SMTP.HOST,
        metadata: {
          service: 'api',
          ...metadata
        }
      });
    } catch (error) {
      const metadata =
      /* istanbul ignore next */
      (cov_1dqtnypwma().s[16]++, this.getMetadata());
      /* istanbul ignore next */
      cov_1dqtnypwma().s[17]++;
      _logging.logger.error('SMTP Connection Error', {
        error: error instanceof Error ?
        /* istanbul ignore next */
        (cov_1dqtnypwma().b[3][0]++, error.message) :
        /* istanbul ignore next */
        (cov_1dqtnypwma().b[3][1]++, String(error)),
        email: _email.EMAIL_CONFIG.SMTP.USER,
        host: _email.EMAIL_CONFIG.SMTP.HOST,
        metadata: {
          service: 'api',
          ...metadata
        }
      });
    }
  }
  async send(options) {
    /* istanbul ignore next */
    cov_1dqtnypwma().f[6]++;
    const startTime =
    /* istanbul ignore next */
    (cov_1dqtnypwma().s[18]++, Date.now());
    const metadata =
    /* istanbul ignore next */
    (cov_1dqtnypwma().s[19]++, this.getMetadata());
    /* istanbul ignore next */
    cov_1dqtnypwma().s[20]++;
    try {
      const result =
      /* istanbul ignore next */
      (cov_1dqtnypwma().s[21]++, await this.transporter.sendMail({
        from: `"${_email.EMAIL_CONFIG.FROM.NAME}" <${_email.EMAIL_CONFIG.FROM.EMAIL}>`,
        ...options
      }));
      /* istanbul ignore next */
      cov_1dqtnypwma().s[22]++;
      _logging.logger.info('Email sent successfully', {
        messageId: result.messageId,
        to: options.to,
        subject: options.subject,
        duration: Date.now() - startTime,
        metadata: {
          service: 'api',
          ...metadata
        }
      });
      /* istanbul ignore next */
      cov_1dqtnypwma().s[23]++;
      return result;
    } catch (error) {
      /* istanbul ignore next */
      cov_1dqtnypwma().s[24]++;
      _logging.logger.error('Failed to send email', {
        error: error instanceof Error ?
        /* istanbul ignore next */
        (cov_1dqtnypwma().b[4][0]++, {
          message: error.message,
          name: error.name,
          stack: error.stack
        }) :
        /* istanbul ignore next */
        (cov_1dqtnypwma().b[4][1]++, String(error)),
        to: options.to,
        subject: options.subject,
        duration: Date.now() - startTime,
        metadata: {
          service: 'api',
          ...metadata
        },
        smtp: {
          user: _email.EMAIL_CONFIG.SMTP.USER,
          host: _email.EMAIL_CONFIG.SMTP.HOST
        }
      });
      /* istanbul ignore next */
      cov_1dqtnypwma().s[25]++;
      throw error;
    }
  }
  async sendVerificationCode(options) {
    /* istanbul ignore next */
    cov_1dqtnypwma().f[7]++;
    const metadata =
    /* istanbul ignore next */
    (cov_1dqtnypwma().s[26]++, this.getMetadata());
    /* istanbul ignore next */
    cov_1dqtnypwma().s[27]++;
    return this.send({
      to: options.to,
      subject: _email.EMAIL_CONFIG.TEMPLATES.VERIFICATION.SUBJECT,
      html: `
        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
          <h1 style="color: #333; text-align: center;">Email Verification</h1>
          <p>Hello ${options.name},</p>
          <p>Please use the following code to verify your email address:</p>
          <div style="background-color: #f4f4f4; padding: 15px; text-align: center; font-size: 24px; letter-spacing: 5px; margin: 20px 0; border-radius: 5px;">
            <strong>${options.code}</strong>
          </div>
          <p>This code will expire in 10 minutes.</p>
          <p>If you didn't request this code, please ignore this email.</p>
          <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee; text-align: center; color: #666;">
            <p>This is an automated message from MGZon</p>
            <p>Sent at: ${metadata.timestamp}</p>
          </div>
        </div>
      `,
      text: `
        Hello ${options.name},

        Please use the following code to verify your email address:

        ${options.code}

        This code will expire in 10 minutes.

        If you didn't request this code, please ignore this email.

        MGZon
        Sent at: ${metadata.timestamp}
      `
    });
  }
  async sendOrderConfirmation(options) {
    /* istanbul ignore next */
    cov_1dqtnypwma().f[8]++;
    const metadata =
    /* istanbul ignore next */
    (cov_1dqtnypwma().s[28]++, this.getMetadata());
    /* istanbul ignore next */
    cov_1dqtnypwma().s[29]++;
    return this.send({
      to: options.to,
      subject: _email.EMAIL_CONFIG.TEMPLATES.ORDER_CONFIRMATION.SUBJECT,
      html: `
        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
          <h1>Order Confirmation</h1>
          <p>Thank you for your order, ${options.user.name}!</p>
          <p>Order #${options.order._id}</p>
          <div style="margin: 20px 0;">
            ${options.order.items.map(item => {
        /* istanbul ignore next */
        cov_1dqtnypwma().f[9]++;
        cov_1dqtnypwma().s[30]++;
        return `
              <div style="padding: 10px; border-bottom: 1px solid #eee;">
                <p>${item.name} x ${item.quantity} - $${(item.price * item.quantity).toFixed(2)}</p>
              </div>
            `;
      }).join('')}
          </div>
          <p><strong>Total:</strong> $${options.order.totalPrice.toFixed(2)}</p>
          <p>Sent at: ${metadata.timestamp}</p>
        </div>
      `,
      text: `
        Order Confirmation

        Thank you for your order, ${options.user.name}!
        Order #${options.order._id}

        ${options.order.items.map(item => {
        /* istanbul ignore next */
        cov_1dqtnypwma().f[10]++;
        cov_1dqtnypwma().s[31]++;
        return `${item.name} x ${item.quantity} - $${(item.price * item.quantity).toFixed(2)}`;
      }).join('\n')}

        Total: $${options.order.totalPrice.toFixed(2)}
        
        Sent at: ${metadata.timestamp}
      `
    });
  }
  async sendPasswordReset(options) {
    /* istanbul ignore next */
    cov_1dqtnypwma().f[11]++;
    const metadata =
    /* istanbul ignore next */
    (cov_1dqtnypwma().s[32]++, this.getMetadata());
    /* istanbul ignore next */
    cov_1dqtnypwma().s[33]++;
    return this.send({
      to: options.to,
      subject: _email.EMAIL_CONFIG.TEMPLATES.PASSWORD_RESET.SUBJECT,
      html: `
        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
          <h1>Password Reset</h1>
          <p>Hello ${options.name},</p>
          <p>Click the button below to reset your password:</p>
          <div style="text-align: center; margin: 20px 0;">
            <a href="${process.env.NEXT_PUBLIC_BASE_URL}/reset-password/${options.resetToken}"
               style="background-color: #007bff; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;">
              Reset Password
            </a>
          </div>
          <p>If you didn't request this, please ignore this email.</p>
          <p style="color: #666; text-align: center; margin-top: 20px;">
            Sent at: ${metadata.timestamp}
          </p>
        </div>
      `,
      text: `
        Password Reset

        Hello ${options.name},

        Click the link below to reset your password:
        ${process.env.NEXT_PUBLIC_BASE_URL}/reset-password/${options.resetToken}

        If you didn't request this, please ignore this email.
        
        Sent at: ${metadata.timestamp}
      `
    });
  }
}
const emailService =
/* istanbul ignore next */
(cov_1dqtnypwma().s[34]++, new EmailService());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJlbWFpbFNlcnZpY2UiLCJFbWFpbFNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImNvdl8xZHF0bnlwd21hIiwiZiIsInMiLCJ0cmFuc3BvcnRlciIsIl9ub2RlbWFpbGVyIiwiZGVmYXVsdCIsImNyZWF0ZVRyYW5zcG9ydCIsInNlcnZpY2UiLCJhdXRoIiwidXNlciIsIl9lbWFpbCIsIkVNQUlMX0NPTkZJRyIsIlNNVFAiLCJVU0VSIiwicGFzcyIsIlBBU1MiLCJyZXBsYWNlIiwicG9vbCIsIm1heENvbm5lY3Rpb25zIiwibWF4TWVzc2FnZXMiLCJzZWN1cmUiLCJwb3J0IiwiZGVidWciLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJsb2dnZXIiLCJ2ZXJpZnlDb25uZWN0aW9uIiwiZm9ybWF0RGF0ZSIsImRhdGUiLCJ0b0lTT1N0cmluZyIsImdldE1ldGFkYXRhIiwidGltZXN0YW1wIiwiRGF0ZSIsImIiLCJDVVJSRU5UX1VTRVIiLCJyZXF1ZXN0SWQiLCJfY3J5cHRvIiwicmFuZG9tVVVJRCIsImlzUmVhZHkiLCJ2ZXJpZnkiLCJtZXRhZGF0YSIsIl9sb2dnaW5nIiwiaW5mbyIsInJlYWR5IiwiZW1haWwiLCJob3N0IiwiSE9TVCIsImVycm9yIiwiRXJyb3IiLCJtZXNzYWdlIiwiU3RyaW5nIiwic2VuZCIsIm9wdGlvbnMiLCJzdGFydFRpbWUiLCJub3ciLCJyZXN1bHQiLCJzZW5kTWFpbCIsImZyb20iLCJGUk9NIiwiTkFNRSIsIkVNQUlMIiwibWVzc2FnZUlkIiwidG8iLCJzdWJqZWN0IiwiZHVyYXRpb24iLCJuYW1lIiwic3RhY2siLCJzbXRwIiwic2VuZFZlcmlmaWNhdGlvbkNvZGUiLCJURU1QTEFURVMiLCJWRVJJRklDQVRJT04iLCJTVUJKRUNUIiwiaHRtbCIsImNvZGUiLCJ0ZXh0Iiwic2VuZE9yZGVyQ29uZmlybWF0aW9uIiwiT1JERVJfQ09ORklSTUFUSU9OIiwib3JkZXIiLCJfaWQiLCJpdGVtcyIsIm1hcCIsIml0ZW0iLCJxdWFudGl0eSIsInByaWNlIiwidG9GaXhlZCIsImpvaW4iLCJ0b3RhbFByaWNlIiwic2VuZFBhc3N3b3JkUmVzZXQiLCJQQVNTV09SRF9SRVNFVCIsIk5FWFRfUFVCTElDX0JBU0VfVVJMIiwicmVzZXRUb2tlbiJdLCJzb3VyY2VzIjpbIi9ob21lL2hhZ2VyL25ldy9teS1uZXh0anMtcHJvamVjdC1tYXN0ZXIgKDMpL215LW5leHRqcy1wcm9qZWN0LW1hc3Rlci9saWIvc2VydmljZXMvZW1haWwvbWFpbGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBub2RlbWFpbGVyIGZyb20gJ25vZGVtYWlsZXInO1xuaW1wb3J0IHsgRU1BSUxfQ09ORklHIH0gZnJvbSAnQC9saWIvY29uZmlnL2VtYWlsJztcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJ0AvbGliL2FwaS9zZXJ2aWNlcy9sb2dnaW5nJztcbmltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJztcblxuLy8g2KrYudix2YrZgSDYp9mE2KPZhtmI2KfYuVxuaW50ZXJmYWNlIEVtYWlsT3B0aW9ucyB7XG4gIHRvOiBzdHJpbmc7XG4gIHN1YmplY3Q6IHN0cmluZztcbiAgaHRtbDogc3RyaW5nO1xuICB0ZXh0OiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBPcmRlckl0ZW0ge1xuICBuYW1lOiBzdHJpbmc7XG4gIHF1YW50aXR5OiBudW1iZXI7XG4gIHByaWNlOiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBPcmRlciB7XG4gIF9pZDogc3RyaW5nO1xuICBpdGVtczogT3JkZXJJdGVtW107XG4gIHRvdGFsUHJpY2U6IG51bWJlcjtcbn1cblxuaW50ZXJmYWNlIFVzZXIge1xuICBuYW1lOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBFbWFpbE1ldGFkYXRhIHtcbiAgdGltZXN0YW1wOiBzdHJpbmc7XG4gIHVzZXI6IHN0cmluZztcbiAgcmVxdWVzdElkOiBzdHJpbmc7XG59XG5cbmNsYXNzIEVtYWlsU2VydmljZSB7XG4gIHByaXZhdGUgdHJhbnNwb3J0ZXI6IG5vZGVtYWlsZXIuVHJhbnNwb3J0ZXI7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy50cmFuc3BvcnRlciA9IG5vZGVtYWlsZXIuY3JlYXRlVHJhbnNwb3J0KHtcbiAgICAgIHNlcnZpY2U6ICdnbWFpbCcsXG4gICAgICBhdXRoOiB7XG4gICAgICAgIHVzZXI6IEVNQUlMX0NPTkZJRy5TTVRQLlVTRVIsXG4gICAgICAgIHBhc3M6IEVNQUlMX0NPTkZJRy5TTVRQLlBBU1M/LnJlcGxhY2UoL1xccy9nLCAnJyksXG4gICAgICB9LFxuICAgICAgcG9vbDogdHJ1ZSxcbiAgICAgIG1heENvbm5lY3Rpb25zOiA1LFxuICAgICAgbWF4TWVzc2FnZXM6IDEwMCxcbiAgICAgIHNlY3VyZTogdHJ1ZSxcbiAgICAgIHBvcnQ6IDQ2NSxcbiAgICAgIGRlYnVnOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyxcbiAgICAgIGxvZ2dlcjogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcsXG4gICAgfSk7XG5cbiAgICB0aGlzLnZlcmlmeUNvbm5lY3Rpb24oKTtcbiAgfVxuXG4gIHByaXZhdGUgZm9ybWF0RGF0ZShkYXRlOiBEYXRlKTogc3RyaW5nIHtcbiAgICByZXR1cm4gZGF0ZS50b0lTT1N0cmluZygpXG4gICAgICAucmVwbGFjZSgvVC8sICcgJylcbiAgICAgIC5yZXBsYWNlKC9cXC4uKy8sICcnKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0TWV0YWRhdGEoKTogRW1haWxNZXRhZGF0YSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRpbWVzdGFtcDogdGhpcy5mb3JtYXREYXRlKG5ldyBEYXRlKCkpLFxuICAgICAgdXNlcjogcHJvY2Vzcy5lbnYuQ1VSUkVOVF9VU0VSIHx8ICdzeXN0ZW0nLFxuICAgICAgcmVxdWVzdElkOiBjcnlwdG8ucmFuZG9tVVVJRCgpXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgdmVyaWZ5Q29ubmVjdGlvbigpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgaXNSZWFkeSA9IGF3YWl0IHRoaXMudHJhbnNwb3J0ZXIudmVyaWZ5KCk7XG4gICAgICBjb25zdCBtZXRhZGF0YSA9IHRoaXMuZ2V0TWV0YWRhdGEoKTtcblxuICAgICAgbG9nZ2VyLmluZm8oJ1NNVFAgQ29ubmVjdGlvbiBTdGF0dXMnLCB7XG4gICAgICAgIHJlYWR5OiBpc1JlYWR5LFxuICAgICAgICBlbWFpbDogRU1BSUxfQ09ORklHLlNNVFAuVVNFUixcbiAgICAgICAgaG9zdDogRU1BSUxfQ09ORklHLlNNVFAuSE9TVCxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBzZXJ2aWNlOiAnYXBpJyxcbiAgICAgICAgICAuLi5tZXRhZGF0YVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgbWV0YWRhdGEgPSB0aGlzLmdldE1ldGFkYXRhKCk7XG4gICAgICBcbiAgICAgIGxvZ2dlci5lcnJvcignU01UUCBDb25uZWN0aW9uIEVycm9yJywge1xuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpLFxuICAgICAgICBlbWFpbDogRU1BSUxfQ09ORklHLlNNVFAuVVNFUixcbiAgICAgICAgaG9zdDogRU1BSUxfQ09ORklHLlNNVFAuSE9TVCxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBzZXJ2aWNlOiAnYXBpJyxcbiAgICAgICAgICAuLi5tZXRhZGF0YVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHNlbmQob3B0aW9uczogRW1haWxPcHRpb25zKSB7XG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCBtZXRhZGF0YSA9IHRoaXMuZ2V0TWV0YWRhdGEoKTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnRyYW5zcG9ydGVyLnNlbmRNYWlsKHtcbiAgICAgICAgZnJvbTogYFwiJHtFTUFJTF9DT05GSUcuRlJPTS5OQU1FfVwiIDwke0VNQUlMX0NPTkZJRy5GUk9NLkVNQUlMfT5gLFxuICAgICAgICAuLi5vcHRpb25zLFxuICAgICAgfSk7XG5cbiAgICAgIGxvZ2dlci5pbmZvKCdFbWFpbCBzZW50IHN1Y2Nlc3NmdWxseScsIHtcbiAgICAgICAgbWVzc2FnZUlkOiByZXN1bHQubWVzc2FnZUlkLFxuICAgICAgICB0bzogb3B0aW9ucy50byxcbiAgICAgICAgc3ViamVjdDogb3B0aW9ucy5zdWJqZWN0LFxuICAgICAgICBkdXJhdGlvbjogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBzZXJ2aWNlOiAnYXBpJyxcbiAgICAgICAgICAuLi5tZXRhZGF0YVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gc2VuZCBlbWFpbCcsIHtcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyB7XG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBuYW1lOiBlcnJvci5uYW1lLFxuICAgICAgICAgIHN0YWNrOiBlcnJvci5zdGFjayxcbiAgICAgICAgfSA6IFN0cmluZyhlcnJvciksXG4gICAgICAgIHRvOiBvcHRpb25zLnRvLFxuICAgICAgICBzdWJqZWN0OiBvcHRpb25zLnN1YmplY3QsXG4gICAgICAgIGR1cmF0aW9uOiBEYXRlLm5vdygpIC0gc3RhcnRUaW1lLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIHNlcnZpY2U6ICdhcGknLFxuICAgICAgICAgIC4uLm1ldGFkYXRhXG4gICAgICAgIH0sXG4gICAgICAgIHNtdHA6IHtcbiAgICAgICAgICB1c2VyOiBFTUFJTF9DT05GSUcuU01UUC5VU0VSLFxuICAgICAgICAgIGhvc3Q6IEVNQUlMX0NPTkZJRy5TTVRQLkhPU1QsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBzZW5kVmVyaWZpY2F0aW9uQ29kZShvcHRpb25zOiB7XG4gICAgdG86IHN0cmluZztcbiAgICBjb2RlOiBzdHJpbmc7XG4gICAgbmFtZTogc3RyaW5nO1xuICB9KSB7XG4gICAgY29uc3QgbWV0YWRhdGEgPSB0aGlzLmdldE1ldGFkYXRhKCk7XG4gICAgXG4gICAgcmV0dXJuIHRoaXMuc2VuZCh7XG4gICAgICB0bzogb3B0aW9ucy50byxcbiAgICAgIHN1YmplY3Q6IEVNQUlMX0NPTkZJRy5URU1QTEFURVMuVkVSSUZJQ0FUSU9OLlNVQkpFQ1QsXG4gICAgICBodG1sOiBgXG4gICAgICAgIDxkaXYgc3R5bGU9XCJmb250LWZhbWlseTogQXJpYWwsIHNhbnMtc2VyaWY7IG1heC13aWR0aDogNjAwcHg7IG1hcmdpbjogMCBhdXRvOyBwYWRkaW5nOiAyMHB4O1wiPlxuICAgICAgICAgIDxoMSBzdHlsZT1cImNvbG9yOiAjMzMzOyB0ZXh0LWFsaWduOiBjZW50ZXI7XCI+RW1haWwgVmVyaWZpY2F0aW9uPC9oMT5cbiAgICAgICAgICA8cD5IZWxsbyAke29wdGlvbnMubmFtZX0sPC9wPlxuICAgICAgICAgIDxwPlBsZWFzZSB1c2UgdGhlIGZvbGxvd2luZyBjb2RlIHRvIHZlcmlmeSB5b3VyIGVtYWlsIGFkZHJlc3M6PC9wPlxuICAgICAgICAgIDxkaXYgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiAjZjRmNGY0OyBwYWRkaW5nOiAxNXB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7IGZvbnQtc2l6ZTogMjRweDsgbGV0dGVyLXNwYWNpbmc6IDVweDsgbWFyZ2luOiAyMHB4IDA7IGJvcmRlci1yYWRpdXM6IDVweDtcIj5cbiAgICAgICAgICAgIDxzdHJvbmc+JHtvcHRpb25zLmNvZGV9PC9zdHJvbmc+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPHA+VGhpcyBjb2RlIHdpbGwgZXhwaXJlIGluIDEwIG1pbnV0ZXMuPC9wPlxuICAgICAgICAgIDxwPklmIHlvdSBkaWRuJ3QgcmVxdWVzdCB0aGlzIGNvZGUsIHBsZWFzZSBpZ25vcmUgdGhpcyBlbWFpbC48L3A+XG4gICAgICAgICAgPGRpdiBzdHlsZT1cIm1hcmdpbi10b3A6IDIwcHg7IHBhZGRpbmctdG9wOiAyMHB4OyBib3JkZXItdG9wOiAxcHggc29saWQgI2VlZTsgdGV4dC1hbGlnbjogY2VudGVyOyBjb2xvcjogIzY2NjtcIj5cbiAgICAgICAgICAgIDxwPlRoaXMgaXMgYW4gYXV0b21hdGVkIG1lc3NhZ2UgZnJvbSBNR1pvbjwvcD5cbiAgICAgICAgICAgIDxwPlNlbnQgYXQ6ICR7bWV0YWRhdGEudGltZXN0YW1wfTwvcD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgLFxuICAgICAgdGV4dDogYFxuICAgICAgICBIZWxsbyAke29wdGlvbnMubmFtZX0sXG5cbiAgICAgICAgUGxlYXNlIHVzZSB0aGUgZm9sbG93aW5nIGNvZGUgdG8gdmVyaWZ5IHlvdXIgZW1haWwgYWRkcmVzczpcblxuICAgICAgICAke29wdGlvbnMuY29kZX1cblxuICAgICAgICBUaGlzIGNvZGUgd2lsbCBleHBpcmUgaW4gMTAgbWludXRlcy5cblxuICAgICAgICBJZiB5b3UgZGlkbid0IHJlcXVlc3QgdGhpcyBjb2RlLCBwbGVhc2UgaWdub3JlIHRoaXMgZW1haWwuXG5cbiAgICAgICAgTUdab25cbiAgICAgICAgU2VudCBhdDogJHttZXRhZGF0YS50aW1lc3RhbXB9XG4gICAgICBgLFxuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIHNlbmRPcmRlckNvbmZpcm1hdGlvbihvcHRpb25zOiB7XG4gICAgdG86IHN0cmluZztcbiAgICBvcmRlcjogT3JkZXI7XG4gICAgdXNlcjogVXNlcjtcbiAgfSkge1xuICAgIGNvbnN0IG1ldGFkYXRhID0gdGhpcy5nZXRNZXRhZGF0YSgpO1xuICAgIFxuICAgIHJldHVybiB0aGlzLnNlbmQoe1xuICAgICAgdG86IG9wdGlvbnMudG8sXG4gICAgICBzdWJqZWN0OiBFTUFJTF9DT05GSUcuVEVNUExBVEVTLk9SREVSX0NPTkZJUk1BVElPTi5TVUJKRUNULFxuICAgICAgaHRtbDogYFxuICAgICAgICA8ZGl2IHN0eWxlPVwiZm9udC1mYW1pbHk6IEFyaWFsLCBzYW5zLXNlcmlmOyBtYXgtd2lkdGg6IDYwMHB4OyBtYXJnaW46IDAgYXV0bzsgcGFkZGluZzogMjBweDtcIj5cbiAgICAgICAgICA8aDE+T3JkZXIgQ29uZmlybWF0aW9uPC9oMT5cbiAgICAgICAgICA8cD5UaGFuayB5b3UgZm9yIHlvdXIgb3JkZXIsICR7b3B0aW9ucy51c2VyLm5hbWV9ITwvcD5cbiAgICAgICAgICA8cD5PcmRlciAjJHtvcHRpb25zLm9yZGVyLl9pZH08L3A+XG4gICAgICAgICAgPGRpdiBzdHlsZT1cIm1hcmdpbjogMjBweCAwO1wiPlxuICAgICAgICAgICAgJHtvcHRpb25zLm9yZGVyLml0ZW1zLm1hcChpdGVtID0+IGBcbiAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cInBhZGRpbmc6IDEwcHg7IGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZWVlO1wiPlxuICAgICAgICAgICAgICAgIDxwPiR7aXRlbS5uYW1lfSB4ICR7aXRlbS5xdWFudGl0eX0gLSAkJHsoaXRlbS5wcmljZSAqIGl0ZW0ucXVhbnRpdHkpLnRvRml4ZWQoMil9PC9wPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIGApLmpvaW4oJycpfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxwPjxzdHJvbmc+VG90YWw6PC9zdHJvbmc+ICQke29wdGlvbnMub3JkZXIudG90YWxQcmljZS50b0ZpeGVkKDIpfTwvcD5cbiAgICAgICAgICA8cD5TZW50IGF0OiAke21ldGFkYXRhLnRpbWVzdGFtcH08L3A+XG4gICAgICAgIDwvZGl2PlxuICAgICAgYCxcbiAgICAgIHRleHQ6IGBcbiAgICAgICAgT3JkZXIgQ29uZmlybWF0aW9uXG5cbiAgICAgICAgVGhhbmsgeW91IGZvciB5b3VyIG9yZGVyLCAke29wdGlvbnMudXNlci5uYW1lfSFcbiAgICAgICAgT3JkZXIgIyR7b3B0aW9ucy5vcmRlci5faWR9XG5cbiAgICAgICAgJHtvcHRpb25zLm9yZGVyLml0ZW1zLm1hcChpdGVtID0+IFxuICAgICAgICAgIGAke2l0ZW0ubmFtZX0geCAke2l0ZW0ucXVhbnRpdHl9IC0gJCR7KGl0ZW0ucHJpY2UgKiBpdGVtLnF1YW50aXR5KS50b0ZpeGVkKDIpfWBcbiAgICAgICAgKS5qb2luKCdcXG4nKX1cblxuICAgICAgICBUb3RhbDogJCR7b3B0aW9ucy5vcmRlci50b3RhbFByaWNlLnRvRml4ZWQoMil9XG4gICAgICAgIFxuICAgICAgICBTZW50IGF0OiAke21ldGFkYXRhLnRpbWVzdGFtcH1cbiAgICAgIGAsXG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgc2VuZFBhc3N3b3JkUmVzZXQob3B0aW9uczoge1xuICAgIHRvOiBzdHJpbmc7XG4gICAgcmVzZXRUb2tlbjogc3RyaW5nO1xuICAgIG5hbWU6IHN0cmluZztcbiAgfSkge1xuICAgIGNvbnN0IG1ldGFkYXRhID0gdGhpcy5nZXRNZXRhZGF0YSgpO1xuXG4gICAgcmV0dXJuIHRoaXMuc2VuZCh7XG4gICAgICB0bzogb3B0aW9ucy50byxcbiAgICAgIHN1YmplY3Q6IEVNQUlMX0NPTkZJRy5URU1QTEFURVMuUEFTU1dPUkRfUkVTRVQuU1VCSkVDVCxcbiAgICAgIGh0bWw6IGBcbiAgICAgICAgPGRpdiBzdHlsZT1cImZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fucy1zZXJpZjsgbWF4LXdpZHRoOiA2MDBweDsgbWFyZ2luOiAwIGF1dG87IHBhZGRpbmc6IDIwcHg7XCI+XG4gICAgICAgICAgPGgxPlBhc3N3b3JkIFJlc2V0PC9oMT5cbiAgICAgICAgICA8cD5IZWxsbyAke29wdGlvbnMubmFtZX0sPC9wPlxuICAgICAgICAgIDxwPkNsaWNrIHRoZSBidXR0b24gYmVsb3cgdG8gcmVzZXQgeW91ciBwYXNzd29yZDo8L3A+XG4gICAgICAgICAgPGRpdiBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgbWFyZ2luOiAyMHB4IDA7XCI+XG4gICAgICAgICAgICA8YSBocmVmPVwiJHtwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CQVNFX1VSTH0vcmVzZXQtcGFzc3dvcmQvJHtvcHRpb25zLnJlc2V0VG9rZW59XCJcbiAgICAgICAgICAgICAgIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogIzAwN2JmZjsgY29sb3I6IHdoaXRlOyBwYWRkaW5nOiAxMHB4IDIwcHg7IHRleHQtZGVjb3JhdGlvbjogbm9uZTsgYm9yZGVyLXJhZGl1czogNXB4O1wiPlxuICAgICAgICAgICAgICBSZXNldCBQYXNzd29yZFxuICAgICAgICAgICAgPC9hPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxwPklmIHlvdSBkaWRuJ3QgcmVxdWVzdCB0aGlzLCBwbGVhc2UgaWdub3JlIHRoaXMgZW1haWwuPC9wPlxuICAgICAgICAgIDxwIHN0eWxlPVwiY29sb3I6ICM2NjY7IHRleHQtYWxpZ246IGNlbnRlcjsgbWFyZ2luLXRvcDogMjBweDtcIj5cbiAgICAgICAgICAgIFNlbnQgYXQ6ICR7bWV0YWRhdGEudGltZXN0YW1wfVxuICAgICAgICAgIDwvcD5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgLFxuICAgICAgdGV4dDogYFxuICAgICAgICBQYXNzd29yZCBSZXNldFxuXG4gICAgICAgIEhlbGxvICR7b3B0aW9ucy5uYW1lfSxcblxuICAgICAgICBDbGljayB0aGUgbGluayBiZWxvdyB0byByZXNldCB5b3VyIHBhc3N3b3JkOlxuICAgICAgICAke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0JBU0VfVVJMfS9yZXNldC1wYXNzd29yZC8ke29wdGlvbnMucmVzZXRUb2tlbn1cblxuICAgICAgICBJZiB5b3UgZGlkbid0IHJlcXVlc3QgdGhpcywgcGxlYXNlIGlnbm9yZSB0aGlzIGVtYWlsLlxuICAgICAgICBcbiAgICAgICAgU2VudCBhdDogJHttZXRhZGF0YS50aW1lc3RhbXB9XG4gICAgICBgLFxuICAgIH0pO1xuICB9XG59XG5cbi8vINiq2LXYr9mK2LEg2YbYs9iu2Kkg2YjYp9it2K/YqSDZhdmGINin2YTYrtiv2YXYqVxuZXhwb3J0IGNvbnN0IGVtYWlsU2VydmljZSA9IG5ldyBFbWFpbFNlcnZpY2UoKTsiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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